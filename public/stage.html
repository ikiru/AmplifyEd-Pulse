<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AmplifyEd Pulse | Stage View</title>
  <link rel="stylesheet" href="css/theme.css" />
  <link rel="stylesheet" href="css/stage.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
  <div class="stage-shell">
    <header class="stage-header">
      <div class="stage-title">AmplifyEd Pulse | Stage View</div>
      <div class="status-pill">
        <span class="status-dot"></span>
        <span id="stage-participant-count">0 participants</span>
      </div>
    </header>

    <section class="stage-focus-card">
      <div class="focus-title">Stage focus</div>
      <p id="stage-focus-text" class="focus-text">
        No focus set yet. Update the focus text from Backstage to announce what the audience should pay attention to.
      </p>
    </section>

    <div class="stage-grid">
      <section class="stage-media">
        <div class="stage-media-header">
          <h2>Video</h2>
          <div class="view-toggle">
            <button id="btn-show-camera" class="toggle-btn active">Camera</button>
            <button id="btn-show-slides" class="toggle-btn">Slides</button>
          </div>
        </div>

        <div id="stage-video-inner" class="camera-mode">
          <div class="camera-view">
            <video id="stage-camera" autoplay playsinline muted></video>
            <div id="camera-status" class="camera-status">Unable to access camera.</div>
          </div>

          <div class="slides-view">
            <div class="slides-controls">
              <span id="slides-indicator">No deck connected</span>
            </div>
            <div class="slides-body">
              <iframe
                id="slides-iframe"
                class="slides-iframe"
                src=""
                frameborder="0"
                allowfullscreen
              ></iframe>
              <div id="slides-placeholder" class="slides-placeholder">
                Connect a slide deck from Backstage to show it here.
              </div>
            </div>
          </div>
        </div>
      </section>

      <div class="stage-side">
        <section class="stage-pulse-card">
          <div class="pulse-heading">
            <span>Live pulse</span>
          </div>
          <div class="pulse-chart-wrapper">
            <div class="live-pulse-graph">
              <canvas id="livePulseChart"></canvas>
            </div>
            <canvas id="stage-pulse-chart"></canvas>
          </div>
          <div class="control-bar">
            <div class="control-left">
              <div id="roomMood" class="room-mood">Roomâ€™s in think mode.</div>
            </div>
          </div>
        </section>

        <section class="session-card">
          <div class="session-card-header">
            <div>
              <div class="session-label">SESSION CODE</div>
              <div id="session-code-value" class="session-code">Generating...</div>
            </div>
            <div class="session-label">Scan to join</div>
          </div>
          <div id="session-qr" class="session-qr"></div>
        </section>
      </div>
    </div>

    <section class="stage-discussion-panel">
      <div class="panel-label">Live discussion</div>
      <div id="stage-discussion-feed" class="discussion-feed"></div>
      <div id="stage-discussion-list" class="discussion-list"></div>
    </section>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <script src="/stage.js" type="module"></script>
</body>

</html>
